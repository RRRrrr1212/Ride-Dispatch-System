# ğŸ§ª æ¸¬è©¦è¨ˆç•«èˆ‡ç‹€æ…‹å ±å‘Š (Test Plan & Status)

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡ä»¶è¨˜éŒ„ Phase 4B çš„æ¸¬è©¦é€²åº¦ï¼ŒåŒ…å«å·²æ’°å¯«çš„æ¸¬è©¦æ¡ˆä¾‹æ¸…å–®ä»¥åŠå¾…å®Œæˆçš„æ¸¬è©¦é …ç›®ã€‚
æ¸¬è©¦ä»£ç¢¼ä½æ–¼ `server/src/test/java/com/uber/` ç›®éŒ„ä¸‹ã€‚

---

## ğŸŸ¢ ç›®å‰å·²æ’°å¯«çš„æ¸¬è©¦ (Implemented Tests)

ä»¥ä¸‹æ¸¬è©¦é¡åˆ¥å·²å»ºç«‹ä¸¦åŒ…å«å…·é«”æ¸¬è©¦é‚è¼¯ï¼š

### 1. æ ¸å¿ƒæœå‹™æ¸¬è©¦ (Unit/Service Tests)
| æ¸¬è©¦é¡åˆ¥ | èªªæ˜ | ç‹€æ…‹ |
|---------|------|------|
| `OrderServiceTest` | æ¸¬è©¦è¨‚å–®å»ºç«‹ã€ç‹€æ…‹æµè½‰ (Create -> Accept -> Start -> Complete) | âœ… å·²å¯¦ä½œ |
| `DriverServiceTest` | æ¸¬è©¦å¸æ©Ÿè¨»å†Šã€ä¸Šç·š/ä¸‹ç·šã€ç‹€æ…‹æ›´æ–° | âœ… å·²å¯¦ä½œ |
| `MatchingServiceTest` | æ¸¬è©¦é…å°æ¼”ç®—æ³• (æ ¹æ“šè·é›¢èˆ‡è»Šç¨®å°‹æ‰¾å¸æ©Ÿ) | âœ… å·²å¯¦ä½œ |
| `FareServiceTest` | æ¸¬è©¦è»Šè³‡è¨ˆç®—é‚è¼¯ (Base + Distance * Rate) | âœ… å·²å¯¦ä½œ |
| `AuditServiceTest` | æ¸¬è©¦å¯©è¨ˆæ—¥èªŒçš„è¨˜éŒ„èˆ‡æŸ¥è©¢ | âœ… å·²å¯¦ä½œ |

### 2. æ§åˆ¶å™¨æ•´åˆæ¸¬è©¦ (Controller Integration Tests)
| æ¸¬è©¦é¡åˆ¥ | èªªæ˜ | ç‹€æ…‹ |
|---------|------|------|
| `OrderControllerTest` | æ¸¬è©¦ `/orders` ç›¸é—œ API ç«¯é» (MockMvc) | âœ… å·²å¯¦ä½œ |
| `DriverControllerTest` | æ¸¬è©¦ `/drivers` ç›¸é—œ API ç«¯é» (MockMvc) | âœ… å·²å¯¦ä½œ |
| `AdminControllerTest` | æ¸¬è©¦ `/admin` ç®¡ç†åŠŸèƒ½ (è¨‚å–®æŸ¥è©¢ã€å¸æ©Ÿç®¡ç†) | âœ… å·²å¯¦ä½œ |

### 3. é€²éšå ´æ™¯æ¸¬è©¦ (Advanced Scenarios)
| æ¸¬è©¦é¡åˆ¥ | èªªæ˜ | ç‹€æ…‹ |
|---------|------|------|
| `ConcurrencyH2Test` | **H2 æ¶å–®ä½µç™¼æ¸¬è©¦**<br>- æ¨¡æ“¬ 10 å€‹åŸ·è¡Œç·’åŒæ™‚æ¶å–®<br>- é©—è­‰åƒ… 1 äººæˆåŠŸï¼Œå…¶ä»–äºº 409 Conflict | âœ… å·²å¯¦ä½œ |
| `IdempotencyH4Test` | **H4 å†ªç­‰æ€§æ¸¬è©¦**<br>- æ¨¡æ“¬é‡è¤‡é€å‡º Accept/Cancel è«‹æ±‚<br>- é©—è­‰è³‡æ–™ä¸€è‡´æ€§èˆ‡å›æ‡‰æ­£ç¢ºæ€§ | âœ… å·²å¯¦ä½œ |

---

## ğŸŸ¡ å¾…å®Œæˆ / éœ€é©—è­‰é …ç›® (To Be Completed)

é›–ç„¶ä¸»è¦æ¸¬è©¦é¡åˆ¥å·²å­˜åœ¨ï¼Œä½†ä»éœ€é€²è¡Œä»¥ä¸‹å·¥ä½œä»¥ç¢ºä¿å“è³ªï¼š

### 1. æ¸¬è©¦åŸ·è¡Œèˆ‡é™¤éŒ¯ (Execution & Debugging)
- [ ] **åŸ·è¡Œå…¨å¥—æ¸¬è©¦**: åŸ·è¡Œ `mvn test` ç¢ºä¿æ‰€æœ‰ 10+ å€‹æ¸¬è©¦é¡åˆ¥çš†é€šé (Green Check)ã€‚
- [ ] **ä¿®å¾© AdminControllerTest**: æ ¹æ“šæœ€æ–°å ±å‘Šï¼Œ`AdminControllerTest` å¯èƒ½ä»æœ‰ 500 éŒ¯èª¤éœ€ä¿®å¾©ã€‚
- [ ] **é©—è­‰ H2 ç©©å®šæ€§**: åœ¨ CI ç’°å¢ƒä¸‹å¤šæ¬¡åŸ·è¡Œä¸¦ç™¼æ¸¬è©¦ï¼Œç¢ºä¿ç„¡ Flaky Testsã€‚

### 2. é‚Šç•Œæ¢ä»¶èˆ‡ç•°å¸¸è™•ç† (Edge Cases)
- [ ] **ç„¡æ•ˆè¼¸å…¥æ¸¬è©¦**: å¢åŠ æ›´å¤šå° Null æˆ–æ ¼å¼éŒ¯èª¤è¼¸å…¥çš„æ¸¬è©¦ (e.g. è² æ•¸åº§æ¨™)ã€‚
- [ ] **è·¨ç‹€æ…‹æ“ä½œ**: æ¸¬è©¦éæ³•ç‹€æ…‹æ“ä½œ (e.g. å¸æ©Ÿåœ¨ Busy ç‹€æ…‹ä¸‹å˜—è©¦æ¥æ–°å–®)ã€‚

### 3. æ¸¬è©¦è¦†è“‹ç‡åˆ†æ (Coverage - Issue #19)
- [ ] **è¨­å®š JaCoCo**: åœ¨ `pom.xml` é…ç½® JaCoCo Pluginã€‚
- [ ] **ç”Ÿæˆå ±å‘Š**: ç”¢å‡º Coverage Reportï¼Œç›®æ¨™è¦†è“‹ç‡ > 80%ã€‚
- [ ] **è£œå¼·æ¸¬è©¦**: é‡å°æœªè¦†è“‹çš„é‚è¼¯åˆ†æ”¯ (Branch Coverage) è£œå……å–®å…ƒæ¸¬è©¦ã€‚

### 4. ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥ (Quality - Issue #20)
- [ ] **PMD æƒæ**: åŸ·è¡Œ PMD æª¢æŸ¥æ½›åœ¨çš„ Code Smells (å¦‚æœªä½¿ç”¨çš„è®Šæ•¸ã€ç©ºçš„ Catch Block)ã€‚

---

## ğŸ› ï¸ åŸ·è¡ŒæŒ‡ä»¤

### åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
```bash
cd server
mvn test
```

### åŸ·è¡Œç‰¹å®šæ¸¬è©¦
```bash
# åƒ…åŸ·è¡Œä¸¦ç™¼æ¸¬è©¦
mvn test -Dtest=ConcurrencyH2Test
```
